webpackJsonp([0],{0:function(e,t,n){e.exports=n(1)},1:function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}var i=n(2),s=o(i);n(3),n(352);var a=n(362),u=r(a);u.server.emitAction$("login",{username:"foo",password:"bar"}).subscribe(function(e){console.log("We're logged in: "+e)},function(e){console.error(e)});var c=(0,s.default)("html");u.usersStore.currentUser$.subscribe(function(e){e.isLoggedIn?(c.removeClass("not-logged-in"),c.addClass("logged-in")):(c.addClass("not-logged-in"),c.removeClass("logged-in"))}),n(414),n(418),n(421),n(543),u.socket.connect()},3:function(e,t,n){"use strict";var r=n(4);r.Observable.prototype.safeSubscribe=function(e,t,n){var r=this.subscribe(function(t){try{e(t)}catch(e){console.error(e.stack||e),r.unsubscribe()}},t,n);return r},r.Observable.prototype.catchWrap=function(){return this.catch(function(e){return r.Observable.of({error:e})})}},352:function(e,t){},362:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.chatStore=t.usersStore=t.server=t.socket=void 0;var o=n(363),i=r(o),s=n(407),a=n(408),u=n(412),c=t.socket=(0,i.default)({autoConnect:!1}),l=t.server=new s.ObservableSocket(c),f=t.usersStore=new a.UsersStore(l);t.chatStore=new u.ChatStore(l,f)},407:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){var t=new Error(e);return t.clientMessage=e,t}function i(e){return u.Observable.throw({clientMessage:e})}function s(){return c}Object.defineProperty(t,"__esModule",{value:!0}),t.ObservableSocket=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.clientMessage=o,t.fail=i,t.success=s;var u=n(4),c=u.Observable.empty();t.ObservableSocket=function(){function e(t){var n=this;r(this,e),this._socket=t,this._state={},this._actionCallbacks={},this._requests={},this._nextRequestId=0,this.status$=u.Observable.merge(this.on$("connect").map(function(){return{isConnected:!0}}),this.on$("disconnect").map(function(){return{isConnected:!1}}),this.on$("reconnecting").map(function(e){return{isConnected:!1,isReconnecting:!0,attempt:e}}),this.on$("reconnect_fail").map(function(){return{isConnected:!1,isReconnecting:!1}})).publishReplay(1).refCount(),this.status$.subscribe(function(e){return n._state=e})}return a(e,[{key:"isConnected",get:function(){return this._state.isConnected}},{key:"isReconnecting",get:function(){return this._state.isReconnecting}},{key:"isTotallyDead",get:function(){return!this.isConnected&&!this.isReconnecting}}]),a(e,[{key:"on$",value:function(e){return u.Observable.fromEvent(this._socket,e)}},{key:"on",value:function(e,t){this._socket.on(e,t)}},{key:"off",value:function(e,t){this._socket.off(e,t)}},{key:"emit",value:function(e,t){this._socket.emit(e,t)}},{key:"emitAction$",value:function(e,t){var n=this._nextRequestId++;this._registerCallbacks(e);var r=this._requests[n]=new u.ReplaySubject(1);return this._socket.emit(e,t,n),r}},{key:"_registerCallbacks",value:function(e){var t=this;this._actionCallbacks.hasOwnProperty(e)||(this._socket.on(e,function(e,n){var r=t._popRequest(n);r&&(r.next(e),r.complete())}),this._socket.on(e+":fail",function(e,n){var r=t._popRequest(n);r&&r.error(e)}),this._actionCallbacks[e]=!0)}},{key:"_popRequest",value:function(e){this._requests.hasOwnProperty(e)||console.error("Event with "+e+" was returned twice, or the server did not send back an ID");var t=this._requests[e];return delete this._requests[e],t}},{key:"onAction",value:function(e,t){var n=this;this._socket.on(e,function(r,o){try{var i=t(r);if(!i)return void n._socket.emit(e,null,o);if("function"!=typeof i.subscribe)return void n._socket.emit(e,i,o);var s=!1;i.subscribe({next:function(t){if(s)throw new Error("Action "+e+" produced more than one value");n._socket.emit(e,t,o),s=!0},error:function(t){n._emitError(e,o,t),console.error(t.stack||t)},complete:function(){s||n._socket.emit(e,null,o)}})}catch(t){"undefined"!=typeof o&&n._emitError(e,o,t),console.error(t.stack||t)}})}},{key:"onActions",value:function(e){for(var t in e)e.hasOwnProperty(t)&&this.onAction(t,e[t])}},{key:"_emitError",value:function(e,t,n){var r=n&&n.clientMessage||"Fatal Error";this._socket.emit(e+":fail",{message:r},t)}}]),e}()},408:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return function(t){return t.users=e,t.users.sort(function(e,t){return e.name.localeCompare(t.name)}),{type:"list",state:t}}}function s(e){return function(t){var n=l.default.findIndex(t.users,function(t){return t.name.localeCompare(e.name)>0});return 1===n&&(n=t.users.length),t.users.splice(n,0,e),{type:"add",user:e,state:t}}}function a(e){return function(t){var n=l.default.findIndex(t.users,{name:e.name});return n!==-1&&t.users.splice(n,1),{type:"remove",user:e,state:t}}}Object.defineProperty(t,"__esModule",{value:!0}),t.UsersStore=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(409),l=r(c),f=n(4),p=n(410);t.UsersStore=function(){function e(t){var n=this;o(this,e),this._server=t;var r={users:[]},u=f.Observable.merge(this._server.on$("users:list").map(i),this._server.on$("users:added").map(s),this._server.on$("users:removed").map(a));this.state$=u.scan(function(e,t){var n=e.state;return t(n)},{state:r}).publishReplay(1),this.state$.connect(),this.currentUser$=f.Observable.merge(this._server.on$("auth:login"),this._server.on$("auth:logout").mapTo({})).startWith({}).publishReplay(1).refCount(),this.currentUser$.subscribe(function(e){return n._currentUser=e}),this._server.on("connect",function(){n._server.emit("users:list"),n.isLoggedIn&&n.login$(n._currentUser.name).subscribe(function(e){return console.log("Logged in again as "+e.name)},function(e){return alert("Could not log back in "+(e.message||"Unknown Error"))})})}return u(e,[{key:"currentUser",get:function(){return this._currentUser}},{key:"isLoggedIn",get:function(){return this._currentUser&&this._currentUser.isLoggedIn}}]),u(e,[{key:"login$",value:function(e){var t=(0,p.validateLogin)(e);return t.hasErrors?f.Observable.throw({message:t.message}):this._server.emitAction$("auth:login",{name:e})}},{key:"logout$",value:function(){return this._server.emitAction$("auth:logout")}}]),e}()},410:function(e,t,n){"use strict";function r(e){var t=new o.Validator;return e.length>=10&&t.error("Username must be fewer than 10 characters"),i.test(e)||t.error("Username can only contain numbers, digits, underscores and dashes"),t}Object.defineProperty(t,"__esModule",{value:!0}),t.USERNAME_REGEX=void 0,t.validateLogin=r;var o=n(411),i=t.USERNAME_REGEX=/^[\w\d_-]+$/},411:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Validator=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(4);t.Validator=function(){function e(){r(this,e),this._errors=[]}return o(e,[{key:"isValid",get:function(){return!this._errors.length}},{key:"errors",get:function(){return this._errors}},{key:"message",get:function(){return this._errors.join(", ")}}]),o(e,[{key:"error",value:function(e){this._errors.push(e)}},{key:"toObject",value:function(){return this.isValid?{}:{errors:this._errors,message:this.message}}},{key:"throw$",value:function(){return i.Observable.throw({clientMessage:this.message})}}]),e}()},412:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ChatStore=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(4),s=n(413);t.ChatStore=function(){function e(t,n){r(this,e),this._server=t,this._users=n,this.messages$=i.Observable.merge(t.on$("chat:list").flatMap(function(e){return i.Observable.from(e)}),t.on$("chat:added")).publishReplay(100),this.messages$.connect(),t.on$("connect").first().subscribe(function(){return t.emit("chat:list")})}return o(e,[{key:"sendMessage$",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",n=(0,s.validateSendMessage)(this._users.currentUser,e,t);return n.isValid?this._server.emitAction$("chat:add",{message:e,type:t}):i.Observable.throw({message:n.message})}}]),e}()},413:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){var r=new a.Validator;return t.length>100&&r.error("Message must be smaller than 100 characters"),0===t.trim().length&&r.error("Message cannot be empty"),s.default.includes(u,n)||r.error("Invalid message type "+n),r}Object.defineProperty(t,"__esModule",{value:!0}),t.MESSAGE_TYPES=void 0,t.validateSendMessage=o;var i=n(409),s=r(i),a=n(411),u=t.MESSAGE_TYPES=["normal"]},414:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2),c=r(u),l=n(415);n(416);var f=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return s(t,e),a(t,[{key:"_onAttach",value:function(){var e=this._$mount.find("h1");e.text("Video player");var t=this._$mount.find("div");t.html('<iframe src="https://r2---sn-8xgp1vo-xfgd.googlevideo.com/videoplayback?id=23393a2587921ca1&itag=22&source=webdrive&requiressl=yes&ttl=transient&pl=18&ei=VdQ6WcDFO8K2qwWTtKTwDg&driveid=0ByEy7t4B9PtcYlFLdVhBR003Nlk&mime=video/mp4&lmt=1491044996515158&ip=2604:a880:0:1010::1b81:f001&ipbits=0&expire=1497042069&sparams=driveid,ei,expire,id,ip,ipbits,itag,lmt,mime,mip,mm,mn,ms,mv,pl,requiressl,source,ttl&signature=406B365E43C8775583892D5FF8400A90C4636009.143B9B535F9887267490F6178F298127A981E6F2&key=cms1&app=explorer&jparams=MTA4LjI3LjgyLjc=&upx=TW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTBfNSkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzU4LjAuMzAyOS4xMTAgU2FmYXJpLzUzNy4zNg&tr=2&cms_redirect=yes&mip=108.27.82.7&mm=31&mn=sn-8xgp1vo-xfgd&ms=au&mt=1497036458&mv=m#12" width="1000" height="500" frameborder="0" allowfullscreen></iframe>')}}]),t}(l.ElementComponent),p=void 0;try{p=new f,p.attach((0,c.default)("section.player"))}catch(e){console.error(e),p&&p.detach()}finally{}},415:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ElementComponent=t.ComponentBase=void 0;var a=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var s=o.get;if(void 0!==s)return s.call(r)},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),l=r(c),f=n(4);f.Observable.prototype.compSubscribe=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=this.safeSubscribe.apply(this,n);return e._onDetachHandlers.push(function(){return o.unsubscribe()}),o};var p=t.ComponentBase=function(){function e(){s(this,e)}return u(e,[{key:"attach",value:function(e){this._$mount=e,this._onDetachHandlers=[],this.children=[],this._onAttach()}},{key:"detach",value:function(){this._onDetach();var e=!0,t=!1,n=void 0;try{for(var r,o=this._onDetachHandlers[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var i=r.value;i()}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}var s=!0,a=!1,u=void 0;try{for(var c,l=this.children[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var f=c.value;f.detach()}}catch(e){a=!0,u=e}finally{try{!s&&l.return&&l.return()}finally{if(a)throw u}}this._onDetachHandlers=[],this.children=[]}},{key:"_onAttach",value:function(){}},{key:"_onDetach",value:function(){}}]),e}();t.ElementComponent=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div";s(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._$element=(0,l.default)("<"+e+">").data("component",n),n}return i(t,e),u(t,[{key:"$element",get:function(){return this._$element}}]),u(t,[{key:"attach",value:function(e){a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"attach",this).call(this,e),this.$element.appendTo(this._$mount)}},{key:"detach",value:function(){a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"detach",this).call(this),this.$element.remove()}},{key:"_setClass",value:function(e,t){t?this._$element.addClass(e):this._$element.removeClass(e)}}]),t}(p)},416:function(e,t){},418:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2),c=r(u),l=n(415),f=n(362);n(419);var p=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"ul"));return e.$element.addClass("users"),e._users=f.usersStore,e}return s(t,e),a(t,[{key:"_onAttach",value:function(){var e=this,t=this._$mount.find("> h1");this._users.state$.map(function(e){return e.state.users}).compSubscribe(this,function(n){t.text(n.length+" user"+(1!=n.length?"s":"")),e.$element.empty();var r=!0,o=!1,i=void 0;try{for(var s,a=n[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var u=s.value,l=(0,c.default)('<span class="name" />').text(u.name).css("color",u.color),f=(0,c.default)("<li />").append(l);e.$element.append(f)}}catch(e){o=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}})}}]),t}(l.ElementComponent),h=void 0;try{h=new p(f.usersStore),h.attach((0,c.default)("section.users"))}catch(e){console.error(e),h&&h.detach()}finally{}},419:function(e,t){},421:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2),c=r(u),l=n(415);n(422);var f=n(362),p=n(424),h=n(542),y=function(e){function t(e,n,r){o(this,t);var s=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s._server=e,s._users=n,s._chat=r,s}return s(t,e),a(t,[{key:"_onAttach",value:function(){var e=this._$mount.find("> h1");e.text("");var t=new p.ChatListComponent(this._server,this._users,this._chat);t.attach(this._$mount),this.children.push(t);var n=new h.ChatFormComponent(this._users,this._chat);n.attach(this._$mount),this.children.push(n)}}]),t}(l.ComponentBase),d=void 0;try{d=new y(f.server,f.usersStore,f.chatStore),d.attach((0,c.default)("section.chat"))}catch(e){console.error(e),d&&d.detach()}finally{}},422:function(e,t){},424:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=e.isConnected,n=e.isReconnecting,r=e.attempt,o=null;return t?o="connected":n?o="reconnecting (attempt "+r+")":status="gg disconnected",null==o?null:(0,p.default)('<li class="server-status" />').append([(0,p.default)('<span class="author" />').text("system"),(0,p.default)('<span class="message" />').text(o),(0,p.default)("<time />").text((0,y.default)().format("h:mm:ss a"))])}function u(e){var t=e.type,n=e.user;return"add"!==t&&"remove"!==t?null:(0,p.default)('<li class="user-action '+t+'" />').append([(0,p.default)('<span class="author" />').text(n.name).css("color",n.color),(0,p.default)('<span class="message" />').text("add"===t?"joined chatroom":"left chatroom"),(0,p.default)("<time />").text((0,y.default)().format("h:mm:ss a"))])}function c(e){var t=e.user,n=e.message,r=e.type,o=e.time;return(0,p.default)('<li class="message '+r+'" />').data("user",t.name).append([(0,p.default)('<span class="author" />').text(t.name).css("color",t.color),(0,p.default)('<span class="message" />').text(n),(0,p.default)("<time />").text((0,y.default)(o).format("h:mm:ss a"))])}Object.defineProperty(t,"__esModule",{value:!0}),t.ChatListComponent=void 0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),f=n(2),p=r(f),h=n(425),y=r(h),d=n(4),b=n(415);t.ChatListComponent=function(e){function t(e,n,r){o(this,t);var s=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"ul"));return s._server=e,s._users=n,s._chat=r,s.$element.addClass("chat-messages"),s}return s(t,e),l(t,[{key:"_onAttach",value:function(){var e=this;d.Observable.merge(this._chat.messages$.map(c),this._users.state$.map(u),this._server.status$.map(a)).filter(function(e){return e}).compSubscribe(this,function(t){e.$element.append(t),e.$element[0].scrollTop=e.$element[0].scrollHeight})}}]),t}(b.ElementComponent)},542:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ChatFormComponent=void 0;var a=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(2),l=r(c),f=n(4),p=n(415);t.ChatFormComponent=function(e){function t(e,n){o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"div"));return r._users=e,r._chat=n,r.$element.addClass("chat-form"),r}return s(t,e),u(t,[{key:"_onAttach",value:function(){var e=this;this._$error=(0,l.default)('<div class="chat-error" />').appendTo(this.$element),this._$input=(0,l.default)('<input type="text" class="chat-input" />').appendTo(this.$element),this._users.currentUser$.compSubscribe(this,function(t){e._$input.attr("placeholder",t.isLoggedIn?"":"Enter a Username")}),f.Observable.fromEvent(this._$input,"keydown").filter(function(e){return 13===e.keyCode}).do(function(e){return e.preventDefault()}).map(function(e){return e.target.value.trim()}).filter(function(e){return e.length}).withLatestFrom(this._users.currentUser$).flatMap(function(t){var n=a(t,2),r=n[0],o=n[1];return o.isLoggedIn?e._sendMessage$(r):e._login$(r)}).compSubscribe(this,function(t){t&&t.error?e._$error.show().text(t.error.message):e._$error.hide()})}},{key:"_sendMessage$",value:function(e){var t=this;return this._chat.sendMessage$(e).catchWrap().do(function(){return t._$input.val("")})}},{key:"_login$",value:function(e){var t=this;return this._$input.attr("disabled","disabled"),this._users.login$(e).catchWrap().do(function(){return t._$input.val("")}).finally(function(){t._$input.attr("disabled",null),t._$input.focus()})}}]),t}(p.ElementComponent)},543:function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2),c=r(u),l=n(415);n(544);var f=n(546),p=n(548),h=n(549),y=n(550),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return s(t,e),a(t,[{key:"_onAttach",value:function(){var e=this._$mount.find("> h1");e.text("Playlist");var t=new p.PlaylistToolbarComponent;t.attach(this._$mount),this._$chrome=(0,c.default)('<div class="chrome" />').appendTo(this._$mount),this._$scrollArea=(0,c.default)('<div class="scroll-area" />').appendTo(this._$chrome);var n=new f.PlaylistListComponent;n.attach(this._$scrollArea);var r=new h.PlaylistContextMenuComponent;r.attach(this._$scrollArea);var o=new y.PlaylistChromeComponent;o.attach(this._$chrome),this.children.push(t,n,r,o)}},{key:"_onDetach",value:function(){this._$chrome.remove()}}]),t}(l.ComponentBase),b=void 0;try{b=new d,b.attach((0,c.default)("section.playlist"))}catch(e){console.error(e),b&&b.detach()}finally{}},544:function(e,t){},546:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistListComponent=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(415),u=n(547);t.PlaylistListComponent=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"ul"));return e.$element.addClass("playlist-list"),e}return i(t,e),s(t,[{key:"_onAttach",value:function(){var e=new u.PlaylistSortComponent;e.attach(this._$mount),this.children.push(e)}}]),t}(a.ElementComponent)},547:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistSortComponent=void 0;var s=n(415);t.PlaylistSortComponent=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return i(t,e),t}(s.ComponentBase)},548:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistToolbarComponent=void 0;var s=n(415);t.PlaylistToolbarComponent=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"div"));return e.$element.addClass("toolbar"),e}return i(t,e),t}(s.ElementComponent)},549:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistContextMenuComponent=void 0;var s=n(415);t.PlaylistContextMenuComponent=function(e){function t(){r(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"div"));return e.$element.addClass("context-menu"),e}return i(t,e),t}(s.ElementComponent)},550:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistChromeComponent=void 0;var s=n(415);t.PlaylistChromeComponent=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return i(t,e),t}(s.ComponentBase)}});
//# sourceMappingURL=application.js.map